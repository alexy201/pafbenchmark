training:
  start_epoch: 0
  max_epochs: 10000
  max_steps: 300000
  precision: 16
  learning_rate: 0.0003
  gradient_clip_val: 1.0
  limit_train_batches: 1.0
  weight_decay: 0.0001
  lr_scheduler:
    use: true
    total_steps: ${..max_steps}
    pct_start: 0.005
    div_factor: 20
    final_div_factor: 10000
validation:
  limit_val_batches: 1.0
  val_check_interval: 10000
  check_val_every_n_epoch: null
batch_size:
  train: 10
  eval: 10
hardware:
  num_workers:
    train: 4
    eval: 4
  gpus:
  - 0
  dist_backend: nccl
  pin_memory: true
logging:
  ckpt_every_n_epochs: 1
  train:
    metrics:
      compute: false
      detection_metrics_every_n_steps: null
    log_model_every_n_steps: 5000
    log_every_n_steps: 500
    high_dim:
      enable: false
      every_n_steps: 5000
      n_samples: 4
  validation:
    high_dim:
      enable: false
      every_n_epochs: 1
      n_samples: 8
model:
  name: rnndet
  backbone:
    name: MaxViTRNN
    compile:
      enable: false
      args:
        mode: reduce-overhead
    input_channels: 20
    enable_masking: false
    partition_split_32: 1
    embed_dim: 64
    dim_multiplier:
    - 1
    - 2
    - 4
    - 8
    num_blocks:
    - 2
    - 2
    - 2
    - 2
    T_max_chrono_init:
    - 4
    - 8
    - 16
    - 32
    stem:
      patch_size: 4
    stage:
      downsample:
        type: patch
        overlap: true
        norm_affine: true
      attention:
        use_torch_mha: false
        partition_size: ???
        dim_head: 32
        attention_bias: true
        mlp_activation: gelu
        mlp_gated: false
        mlp_bias: true
        mlp_ratio: 4
        drop_mlp: 0
        drop_path: 0
        ls_init_value: 1.0e-05
      lstm:
        dws_conv: false
        dws_conv_only_hidden: true
        dws_conv_kernel_size: 3
        drop_cell_update: 0
  fpn:
    name: PAFPN
    compile:
      enable: false
      args:
        mode: reduce-overhead
    depth: 0.67
    in_stages:
    - 2
    - 3
    - 4
    depthwise: false
    act: silu
  head:
    name: YoloX
    compile:
      enable: false
      args:
        mode: reduce-overhead
    depthwise: false
    act: silu
  postprocess:
    confidence_threshold: 0.1
    nms_threshold: 0.45
dataset:
  name: paf_event
  train_folder: /home/as4296/palmer_scratch/vit/paf/train
  raw_folder: /home/as4296/palmer_scratch/vit/paf/raw
  classnames: /home/as4296/palmer_scratch/vit/paf/train/classes.json
  num_bins: 20
  height: 260
  width: 346
  train:
    sampling: mixed
    random:
      weighted_sampling: false
    mixed:
      w_stream: 1
      w_random: 1
  eval:
    sampling: stream
  ev_repr_name: stacked_histogram_dt=50_nbins=10
  sequence_length: 5
  downsample_by_factor_2: false
  only_load_end_labels: false
encoder_model:
  encoder:
    input_channels: 20
    encoder_input_channels: 64
    num_heads: 8
    dim_multiplier:
    - 1
    - 2
    - 4
    - 8
    num_blocks:
    - 2
    - 2
    - 2
    - 2
    partition_split_32: 2
    attention:
      partition_size: ???
      scale: 0.25
      num_heads: 8
  downsample:
    input_dim: 20
    first_layer_dim: 32
